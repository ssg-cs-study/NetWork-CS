# NAT
NAT는 이름 그대로 네트워크 주소를 변환하는 기술입니다.

NAT는 기본적으로 하나의 네트워크 주소에 다른 하나의 네트워크 주소로 변환하는 1:1 변환이 기본이지만 IP 주소가 고갈되는 문제를 해결하기 위해 1:1 변환이 아닌 여래 개의 IP를 하나의 IP로 변환하기도 합니다.

여러 개의 IP를 하나의 IP로 변환하는 기술도 NAT 기술 중 하나이고 NAT로 통칭하여 불리기도 하지만 실제로 공식 용어는 NAPT입니다. 실무에서는 PAT라는 용어로 더 많이 사용되서 PAT라고 설명하겠다.

NAT는 사설 IP에서 공인 IP로 전환하는 것뿐만 아니라 공인 IP에서 사설 IP로 주소를 전환할 수 있고 사설 IP에서 또 다른 사설 IP나 공인 IP에서 또 다른 공인 IP로전환도 NAT로 정의될 수 있다.

### NAT/PAT의 용도와 필요성
- 첫째, IPv4 주소 고갈문제의 솔루션을 NAT가 사용됩니다.

인터넷 대중화로 갑자기 폭증한 IP 주소 요구를 극복하기 위해 단기, 중기, 장기의 3단계 IP 주소 보존과 전환 전략이 수립했습니다.

IPv4 주소 보존전략 중 단기 전략은 서브네팅, 중기 전략은 NAT와 사설 IP 체계, 장기 전략은 IPv6 전환이었습니다.

- 둘째, 보안을 강화하는데 NAT 기술을 사용합니다.

IP 주소는 네트워크에서 유일해야 하고 이 정보가 식별자로 사용되어 외부와 통신하게 해줍니다.

외부와 통신할 때 내부 IP를 다른 IP로 변환해 통신하면 외부에 사내 IP 주소 체계를 숨길 수 있습니다.

NAT는 주소 변환 후 역변환이 정상적으로 다시 수행되어야만 통신이 가능합니다.

이 성질을 이용해 복잡한 룰 설정 없이 방향성을 통제할 수 있습니다.

내부 네트워크에서 외부 네트워크로 나가는 방향 통신은 허용하지만 외부에서 시작해 내부로 들어오는 통신은 방어할 수 있습니다.

NAT/PAT의 이런 성질을 이용해 보안을 쉽게 강화할 수 있습니다.

- 셋째, IP 주소 체계가 같은 두개의 네트워크 간 통신을 가능하게 해줍니다.

IP 네트워크에서 서로 통신하려면 식별 가능한 유일한 IP 주소가 있어야 합니다.

공인 IP는 인터넷에서 유일한 주소로 IP 주소가 중복되면 안 되지만 사설 IP는 외부와 통신할 때 공인 IP로 변환되어 통신하므로 서로 다른 회사에서 중복해 사용할 수 있습니다.

회사 내부에서 사설 IP를 독립적으로 사용한다면 상관없지만 사설IP를 이용해 다른 회사와 직접 연결해야 하거나 회사 간 합병으로 서로 통신해야 한다면 사설IP주소가 충돌할 수 있습니다.

- 넷째 불필요한 설정 변경을 줄일 수 있습니다.

KISA를 통해 인터넷 독립기관으로 직접 등록하고 소유한 IP 주소를 직접 운영하는 경우가 아니라면 통신사업자나 IDC 쪽에서 IP를 할당받아 사용하게 됩니다.

이 IP들은 자신이 소유한 것이 아니라 임시로 빌려 사용하는 것이므로 회선 사업자를 바꾸거나 IDC를 이전하면 그동안 빌려 써왔던 공인 IP를 더 이상 사용할 수 없고 신규 사업자가 빌려주는 IP로 변경해야 합니다.

만약 사용자가 NAT/PAT를 이용해서 내부 네트워크를 구성하고 있었다면 서버와 PC의 IP 주소 변경 없이 회선과 IDC 사업자 이전이 가능합니다.

물론 외부에 서비스하던 공인 IP 주소가 변경되므로 DNS 서비스나 NAT를 수행하는 네트워크 장비 설정은 변경해야 하지만 내부 서버나 PC 설정 변경을 최소화할 수 있어 NAT/PAT 기술을 적용하면 복잡한 작업을 많이 줄일 수 있습니다.

##### NAT의 단점
네트워크 운영자 입장에서는 IP가 변환되면 장애가 발생했을 때 문제 해결이 힘듭니다.

애플리케이션 개발자는 NAT 환경이 대중화되면서 애플리케이션을 개발할 때 더많은 고려사항이 생겼습니다.

IPv6 전환은 IPv4 주소 부족 해결이라는 중요한 목표가 있지만 이런 어려움을 주는 NAT를 인터넷에서 없애는 목표도 있습니다.

NAT로 인해 주소가 변환되면서 단말 간 직접적인 연결성이 무너졌고 이로 인해 개발자들이 애플리케이션을 제작할 때 NAT 환경을 항상 고려해야 하는 상황이 되었습니다.

### NAT 동작 방식
![KakaoTalk_20230920_202918868](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/f35f4bb7-af1c-4fad-b3e4-449a332dd197)


### PAT 동작 방식
![KakaoTalk_20230920_202918868_01](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/637923c4-3045-49a6-890d-5beaa46e62dd)

### SNAT / DNAT  
![KakaoTalk_20230920_203153715](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/3daabca8-0f87-43c5-b9a1-10a0b448c825)

### 동적 NAT / 정적 NAT
![동적NAT 정적NAT](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/d5dd8616-81a0-4960-a487-5ec5e787e848)

