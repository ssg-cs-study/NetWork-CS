### 데이터링크 계층

OSI 7계층에서 2계층인 데이터링크 계층

네트워크란 통신을 위한 것

쉽게 설명하면 네트워크는 내가 다른 사람과 편지를 주고받을 수 있게 해주는 우체국 시스템

하지만 컴퓨터끼리 서로 편지를 주고 받기 위해서는 IP주소를 사용하고 있음

→ 그럼 내 컴퓨터는 전세계의 수많은 컴퓨터 IP를 기억하고 있는걸까? = 기억하지 않는다

여기서 IP는 네트워크 계층으로 2계층인 데이터링크 계층보다 한 단계 위인 3계층임

편지를 잘 주고 받을 수 있도록 3계층 네트워크 계층으로 가기 전 데이터링크 계층에서 일련의 작업을 거침

물리 계층과 네트워크 계층 사이에 껴서 소프트웨어, 하드웨어적 특성을 모두 가지고 있음

→ 소프트웨어로부터 정보를 전달 받으면 하드웨어로 연결 또는 회선(하드웨어)으로 부터 데이터를 받아서 우리가 볼 수 있게 소프트웨어 특징을 갖는 레이어로 전달

예시)

한국에서 미국으로 메시지 보낼 거야 !

순간이동으로 바로 갈 수 있을까? → 아니

이웃 간의 데이터 전송이 보장되어야 멀리까지 데이터도 전송될 수 있는 것-! 여기서 중요한 것이 데이터링크 계층은 직접 연결된 서로 다른 2개의 네트워크 장치간 데이터 전송을 담당 !

그래서 직접 연결되지 않은 장치에는 데이터를 보낼 수 없다 !

그렇기 때문에 멀리 떨어진 곳으로 메시지를 보낸다 치면 각 노드들을 타고 데이터가 타고타고 전달되어 원하던 곳으로 메시지를 보내줌

→ 일단 연결된 바로 이웃 컴퓨터와의 통신만을 생각함

네트워크 계층에서는 오른쪽으로 가라 왼쪽으로 가라는 등 방향을 지시해주지만 데이터링크 계층은 갈래길이 있는 곳까지 안내해주는 안내원이라고 생각하면 쉬움

![001](https://github.com/ssg-cs-study/NetWork-CS/assets/136298009/42abaa7c-b094-4351-9ed6-d9097ddd6dc6)


데이터링크 계층은 LAN에서 데이터를 어떤 형태로 받고 보낼지 결정하는 구간.

주요 프로토콜에는 이더넷, RPC, WinSock 등이 있음

cf) 네트워크 장비 간 신호를 주고 받는 규칙에 대해 정해 놓은 계층

이더넷 : 데이터링크 계층에서 사용하는 프로토콜로 CSMA/CD방식을 사용하여 여러 개의 컴퓨터가 공유 매체를 사용할 수 있게 해주고, 스위치에서 MAC 주소를 이용해서 데이터를 필요로 하는 컴퓨터에게만 전달할 수 있도록 해줌

이전에는 CSMA/CD 방식을 많이 이용했지만 요즘에는 스위치라는 네트워크 장비를 사용하여 충돌을 방지함

CSMA/CD란 데이터를 보내려고 하는 컴퓨터가 케이블 신호가 흐르는 지의 유무를 확인 + 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋다는 규칙 + 충돌이 발생하고 있는 지를 확인한다는 규칙

MAC 주소 : LAN 카드에 부여하는 번호로써 제조사 번호와 독립적인 일련번호가 쓰여있으며 전 세계에 각자 유일하고 물리 주소라고도 말함 → 즉 우리의 이메일을 생각하면 쉬움 !

ex) 01-23-45-A2-B3-CD

0~5는 LAN 카드 제조한 제조사 번호 / A~D  제조사가 LAN 카드에 붙인 일련번호. 각 24bit씩 총 48bit

![002](https://github.com/ssg-cs-study/NetWork-CS/assets/136298009/20a3f5d9-0bdc-4cab-a504-cca8c22c86d5)


이더넷 프레임의 시작과 동기화 / 목적지 MAC 주소 / 출발 MAC 주소 / 캡슐화되어 있는 패킷의 프로토콜 정의 / 상위 계층의 데이터(46~1500바이트가 들어가며 46바이트보다 작을 경우 이를 맞추기 위해 패딩 데이터가 붙음) / 프레임 에러 체크

데이터링크 계층은 이더넷 헤더와 트레일러는 붙인 프레임이라는 데이터를 만듦

→ 이더넷 헤더 : 목적지의 MAC 주소 (48비트 = 6바이트)와 출발지 MAC 주소와 유형 (2바이트). 이전 계층의 틀에 붙여서 나타냄

→ 트레일러 : FCS라고도 하며 데이터 전송 도중에 오류가 발생했는지 체크하는 용도

이렇게 이더넷 헤더와 트레일러가 추가된 캡슐화된 데이터가 물리 계층에서 전기 신호를 바꿔서 전송하는 것 !!

- 데이터링크 계층 - 스위치와 내부 동작

→ 스위치 : 집에서 일반적으로 사용하는 허브보다 성능이 좋음

동작 방식 : learning → (flooding, forwarding, filtering) → aging

즉, 프레임이 유입되면 신규 주소일 경우 출발지 주소를 저장하는데 이를 learning

기존 주소일 경우 aging 타이머를 재시작하는데 이것을 refresh

그 다음 목적지 주소가 MAC 주소 테이블에 없으면 전체 Port로 브로드캐스팅 전달 수행

forwarding은 MAC 테이블에 일치하는 경로로 전송해주는 기능(유니캐스팅 전달)

filtering은 출발지가 목적지가 같은 영역이면 다른 네트워크로 전달하지 않음

aging은 MAC 테이블을 관리하기 위한 기법으로 한번 사용된 MAC 주소가 일정 시간 사용되지 않으면 삭제하고 기본 300초의 저장 시간을 가짐

cf) 허브 : 여러 대의 컴퓨터를 연결해서 네트워크를 만들어주는 장치. 데이터 패킷을 받으면 연결된 모든 장치에 신호를 보냄. 단순 분배를 하는 중계 장치.

스위치 : 연결된 장치의 IP와 MAC 주소를 모두 테이블 형태로 가지고 원하는 목적지에 데이터와 패킷을 전송하는 장치

- 데이터가 케이블에서 충돌하지 않는 구조

전이중 통신 VS 반이중 통신

데이터의 송수신을 동시에 통신하는 방식 / 회선 하나로 송신과 수신을 번갈아가며 통신하는 방식

반이중 통신의 경우 데이터를 동시에 전송하면 충돌이 생김

컴퓨터를 직접 랜 케이블로 연결한다면 전이중 통신이 되고 허브로 연결하면 허브의 내부에는 송수신이 나누어져 있지 않아 회선 하나를 송수신이 번갈아가면서 사용하는 반이중 통신을 함

데이터링크 계층은 물리 계층을 보완하는 계층임

이더넷의 종류의 경우는 줄줄 읽는 설명이 될 거 같아 각자 책 참고

- 물리계층

허브 / 리피터 : 리피터의 경우 최근에는 사용하지 않음

허브는 단순한 중계기 역할

데이터 전송 성능지표 

성능지표 단위 : BackPlan 최대 데이터 처리량

CPS : 초당 커넥션

CC : 최대 수용 가능 커넥션

TPS : 초당 트랙잭션 연결
